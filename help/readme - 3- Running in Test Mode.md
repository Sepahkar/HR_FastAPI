# ************************************************************ HR System – راهنمای راه‌اندازی (مرحله ۳)
# اجرای تستی پروژه و بررسی صحت عملکرد

در این مرحله فرض می‌کنیم که:
- مراحل ۱ و ۲ را کامل انجام داده‌اید
- پروژه در مسیر مشخص روی سیستم شما قرار دارد
- Virtual Environment ساخته و فعال شده است
- کتابخانه‌ها با موفقیت نصب شده‌اند

هدف این مرحله:
- اجرای Backend به‌صورت محلی (Test Mode)
- اطمینان از سلامت Backend
- تست APIها
- آماده شدن برای راه‌اندازی روی IIS

---

## 1️⃣ اطمینان از فعال بودن Virtual Environment

قبل از هر کاری، مطمئن شوید که Virtual Environment فعال است.

در Command Prompt باید ابتدای خط چیزی شبیه زیر ببینید:

(venv) C:\Projects\HR\backend>

اگر (venv) را نمی‌بینید، دستور زیر را اجرا کنید:

venv\Scripts\activate

---

## 2️⃣ اجرای Backend به‌صورت تستی

در همان مسیر backend دستور زیر را اجرا کنید:

python run.py

اگر Backend درست اجرا شود، باید اتفاقات زیر را ببینید:

- پیام شروع برنامه در Command Prompt
- لاگ‌هایی شبیه:
  - HR SYSTEM STARTING
  - Environment : DEV
  - Database connection OK

اگر در این مرحله خطا دیدید:
- متن خطا را یادداشت کنید
- به مرحله ۴ (خطاها) مراجعه کنید
- یا از مسئول پروژه سؤال بپرسید

---

## 3️⃣ تست Backend در مرورگر (Swagger)

مرورگر را باز کنید و آدرس زیر را وارد کنید:

http://localhost:8000/docs

اگر Backend سالم باشد:
- یک صفحه با عنوان Swagger UI باز می‌شود
- لیست APIها را می‌بینید
- می‌توانید APIها را تست کنید

اگر این صفحه باز نشد:
- Backend اجرا نشده است
- یا پورت 8000 توسط برنامه دیگری اشغال شده است

---

## 4️⃣ تست Health Check سیستم

در مرورگر آدرس زیر را وارد کنید:

http://localhost:8000/health

خروجی مورد انتظار:

{
  "status": "ok",
  "database": "connected",
  "environment": "DEV"
}

توضیح:
- status = ok  → Backend سالم است
- database = connected → اتصال دیتابیس برقرار است

اگر database برابر disconnected بود:
- تنظیمات دیتابیس در فایل .env را بررسی کنید
- مطمئن شوید SQL Server در حال اجراست

---

## 5️⃣ تست API لیست کاربران

در مرورگر یا Swagger آدرس زیر را تست کنید:

http://localhost:8000/api/hr/users

خروجی مورد انتظار:
- یک لیست (آرایه) از کاربران
- هر آیتم شامل:
  - NationalCode
  - FirstName
  - LastName
  - ContractDate

اگر خطا دریافت کردید:
- دیتابیس درست وصل نشده
- یا View / Table مورد نظر وجود ندارد

---

## 6️⃣ تست API کاربر جاری (DEV Mode)

در حالت DEV، کاربر از متغیر DEV_USER خوانده می‌شود.

آدرس زیر را در مرورگر باز کنید:

http://localhost:8000/api/hr/me

خروجی مورد انتظار:

{
  "username": "test.user",
  "full_name": "test.user@eit"
}

اگر این API خطا داد:
- فایل .env را بررسی کنید
- مقدار DEV_USER باید وجود داشته باشد

---

## 7️⃣ تست Frontend به‌صورت محلی

به مسیر frontend بروید:

C:\Projects\HR\frontend\

روی فایل index.html دوبار کلیک کنید (Double Click).

اگر همه چیز درست باشد:
- صفحه HR باز می‌شود
- بالای صفحه نام کاربر نمایش داده می‌شود
- جدول لیست کاربران نمایش داده می‌شود

اگر جدول خالی بود:
- Backend اجرا نیست
- یا API /api/hr/users خطا دارد

---

## 8️⃣ بررسی خطاها در مرورگر

در صفحه Frontend:
- کلید F12 را بزنید
- به تب Console بروید

نباید خطای قرمز ببینید.

اگر خطای 404 یا 500 دیدید:
- آدرس API اشتباه است
- Backend اجرا نیست
- یا CORS مشکل دارد

---

## 9️⃣ جمع‌بندی مرحله سوم

در پایان این مرحله، باید مطمئن باشید که:

- Backend بدون خطا اجرا می‌شود
- Swagger در دسترس است
- Health Check سالم است
- APIها داده برمی‌گردانند
- Frontend داده‌ها را نمایش می‌دهد

اگر حتی یکی از این موارد درست کار نکند:
- به مرحله بعد نروید
- ابتدا مشکل را برطرف کنید

---

