# 📚 راهنمای جامع پروژه HR

## 🎯 نمای کلی پروژه

این پروژه یک **سیستم مدیریت منابع انسانی (HR)** است که با معماری **Client-Server** طراحی شده است:

- **Frontend**: واجهه کاربری با Vue.js
- **Backend**: سرور Python (FastAPI)
- **Database**: پایگاه داده (تنظیم شده در `core/database.py`)
- **Server**: IIS (برای استقرار)

---

## 📁 ساختار پروژه

```
NewHR/
├── frontend/          # واجهه کاربری (صفحات و اجزا)
├── backend/           # منطق کسب‌وکار (API ها و سرویس‌ها)
├── logs/              # فایل‌های لاگ
├── requirements.txt   # وابستگی‌های پایتون
├── web.config         # تنظیمات IIS
└── readme files       # راهنماهای مختلف
```

---

## 🏗️ معماری سیستم

```
┌─────────────────────────────────────────────────────────┐
│                    مرورگر کاربر                         │
│              (Chrome, Firefox, Edge)                    │
└────────────────────┬────────────────────────────────────┘
                     │ HTTP/AJAX
                     ↓
┌─────────────────────────────────────────────────────────┐
│                   Frontend (Vue.js)                     │
│  ┌──────────────────────────────────────────────────┐  │
│  │ Components (Views)    API Calls    Static Files │  │
│  │ UserList.vue    →    axios    →   CSS/JS       │  │
│  │ UserProfile.vue                   Images       │  │
│  └──────────────────────────────────────────────────┘  │
└────────────────────┬────────────────────────────────────┘
                     │ REST API
                     ↓
┌─────────────────────────────────────────────────────────┐
│                Backend (FastAPI - Python)               │
│  ┌──────────────────────────────────────────────────┐  │
│  │ Routes (router.py)                             │  │
│  │    ↓                                            │  │
│  │ Controllers (service.py)                       │  │
│  │    ↓                                            │  │
│  │ Data Access (repository.py)                    │  │
│  │    ↓                                            │  │
│  │ Schemas (schemas.py)                           │  │
│  └──────────────────────────────────────────────────┘  │
└────────────────────┬────────────────────────────────────┘
                     │ SQL
                     ↓
┌─────────────────────────────────────────────────────────┐
│                  پایگاه داده                            │
│              (Database Server)                          │
└─────────────────────────────────────────────────────────┘
```

---

## 🔍 توضیح هر بخش

### 1️⃣ **Frontend (واجهه کاربری)**

#### 📂 مسیر: `frontend/`

| فایل/پوشه | توضیح |
|----------|-------|
| `index.html` | صفحه HTML اولیه |
| `package.json` | وابستگی‌های Node.js و Vite |
| `vite.config.js` | تنظیمات Vite (بیلد تول) |
| `js/` | فایل‌های جاوا اسکریپت |
| ├─ `app.js` | منطق اصلی اپلیکیشن |
| ├─ `axios.min.js` | کتابخانه برای API calls |
| └─ `vue.global.prod.js` | فریم‌ورک Vue.js |
| `css/` | فایل‌های استایل |
| ├─ `app.css` | استایل‌های اختصاصی |
| ├─ `bootstrap.min.css` | فریم‌ورک Bootstrap |
| └─ `all.min.css` | استایل‌های عمومی |
| `src/` | کد منبع Vue.js |
| ├─ `main.js` | نقطه شروع Vue |
| ├─ `api/hr.js` | API calls برای HR |
| └─ `views/` | صفحات اصلی |
|    ├─ `UserList.vue` | لیست کاربران |
|    └─ `UserProfile.vue` | پروفایل کاربر |
| `assets/` | تصاویر، آیکون‌ها و فونت‌ها |

**عملکرد Frontend:**
```
کاربر درخواست می‌دهد
    ↓
Vue.js صفحه را رندر می‌کند
    ↓
axios یک API request می‌فرستد
    ↓
Backend پاسخ می‌دهد
    ↓
صفحه به‌روز می‌شود
```

---

### 2️⃣ **Backend (سرور)**

#### 📂 مسیر: `backend/`

| فایل/پوشه | توضیح |
|----------|-------|
| `run.py` | فایل اجرای اصلی (نقطه شروع) |
| `app/main.py` | فایل اولیه Flask/FastAPI |
| `app/core/` | تنظیمات اصلی |
| ├─ `auth.py` | احراز هویت و اعتبارسنجی |
| ├─ `config.py` | تنظیمات پروژه |
| ├─ `database.py` | اتصال به پایگاه داده |
| └─ `logging.py` | ثبت رویدادها |
| `app/modules/` | ماژول‌های مختلف |
| └─ `hr/` | ماژول منابع انسانی |
|    ├─ `router.py` | تعریف endpoints (مسیرهای API) |
|    ├─ `service.py` | منطق کسب‌وکار |
|    ├─ `repository.py` | دسترسی به داده |
|    └─ `schemas.py` | تعریف ساختار داده |
| `app/shared/` | ابزارهای مشترک |
| └─ `utils.py` | توابع کمکی |
| `logs/` | فایل‌های لاگ |

**ساختار درخواست در Backend:**
```
HTTP Request (مثلاً GET /api/users)
    ↓
router.py → تعیین endpoint مناسب
    ↓
service.py → اجرای منطق کسب‌وکار
    ↓
repository.py → دریافت/ذخیره داده
    ↓
database.py → اجرای SQL query
    ↓
پایگاه داده ← اطلاعات
    ↓
JSON Response برگشت
```

---

### 3️⃣ **جریان درخواست کامل**

#### مثال: دریافت لیست کاربران

```
1. کاربر روی دکمه "نمایش کاربران" کلیک می‌کند
   └─ پوشه: frontend/src/views/

2. Vue.js مرتبط شود و UserList.vue را لود می‌کند
   └─ فایل: frontend/src/views/UserList.vue

3. Frontend یک API call می‌فرستد
   └─ فایل: frontend/src/api/hr.js
   └─ درخواست: GET http://server/api/hr/users

4. Backend درخواست را دریافت می‌کند
   └─ فایل: backend/app/modules/hr/router.py
   └─ router endpoint را می‌شناسد

5. Service منطق را اجرا می‌کند
   └─ فایل: backend/app/modules/hr/service.py
   └─ تحقق‌های احراز هویت و مجوزات

6. Repository داده را می‌خواهد
   └─ فایل: backend/app/modules/hr/repository.py
   └─ کوئری نوشته می‌شود

7. Database پاسخ می‌دهد
   └─ فایل: backend/app/core/database.py
   └─ نتایج SQL

8. Response به Frontend برمی‌گردد
   └─ فایل: frontend/src/api/hr.js
   └─ axios پاسخ را دریافت می‌کند

9. صفحه به‌روز می‌شود
   └─ پوشه: frontend/src/views/
   └─ جدول کاربران نمایش داده می‌شود
```

---

## 🛠️ چگونه مسائل را حل کنیم؟

### ❌ مشکل: صفحه بارگذاری نمی‌شود

**چک‌لیست:**

| مرحله | فایل | چه‌کار |
|------|-----|-------|
| 1 | `frontend/index.html` | بررسی کنید که فایل موجود است |
| 2 | مرورگر Console (F12) | خطاهای جاوا اسکریپت را ببینید |
| 3 | `frontend/src/main.js` | بررسی كنید Vue سرمایه‌گذاری شود |
| 4 | `frontend/vite.config.js` | تنظیمات Vite را بررسی کنید |

---

### ❌ مشکل: API call ناموفق (درخواست Backend شکست می‌خورد)

**چک‌لیست:**

| مرحله | فایل | چه‌کار |
|------|-----|-------|
| 1 | `backend/run.py` | بررسی کنید Backend راه‌اندازی شده است |
| 2 | `backend/app/core/config.py` | URL و تنظیمات سرور را بررسی کنید |
| 3 | `backend/logs/` | لاگ‌های خطا را ببینید |
| 4 | `frontend/src/api/hr.js` | URL endpoint را بررسی کنید |
| 5 | Network Tab در F12 | HTTP status code را ببینید |

---

### ❌ مشکل: خطای Database

**چک‌لیست:**

| مرحله | فایل | چه‌کار |
|------|-----|-------|
| 1 | `backend/app/core/database.py` | رشته اتصال را بررسی کنید |
| 2 | `backend/logs/` | لاگ‌های Database را ببینید |
| 3 | `requirements.txt` | بررسی کنید drivers نصب شده‌اند |
| 4 | پایگاه داده | بررسی کنید سرور در دسترس است |

---

### ❌ مشکل: خطای احراز هویت (Authentication)

**چک‌لیست:**

| مرحله | فایل | چه‌کار |
|------|-----|-------|
| 1 | `backend/app/core/auth.py` | منطق احراز هویت را بررسی کنید |
| 2 | `backend/app/modules/hr/service.py` | مجوزات را بررسی کنید |
| 3 | `backend/logs/` | رویدادهای احراز هویت را ببینید |
| 4 | `frontend/src/api/hr.js` | token یا cookies را بررسی کنید |

---

### ❌ مشکل: سبک‌ها و طراحی خراب است

**چک‌لیست:**

| مرحله | فایل | چه‌کار |
|------|-----|-------|
| 1 | `frontend/css/` | فایل‌های CSS را بررسی کنید |
| 2 | `frontend/assets/` | تصاویر و فونت‌ها را بررسی کنید |
| 3 | مرورگر Console | خطاهای CSS را ببینید |
| 4 | `frontend/vite.config.js` | مسیرهای static files را بررسی کنید |

---

## 📝 فایل‌های مهم و نقش آن‌ها

### 🔴 **نقطه شروع Backend**
```
backend/run.py
└─→ سرور Python را راه‌اندازی می‌کند
```

### 🔴 **نقطه شروع Frontend**
```
frontend/index.html
└─→ صفحه اولیه مرورگر را بارگذاری می‌کند
```

### 🔴 **تنظیمات اتصال**
```
backend/app/core/config.py
└─→ URL، پورت، پایگاه داده را مشخص می‌کند
```

### 🔴 **Endpoints (مسیرهای API)**
```
backend/app/modules/hr/router.py
└─→ تمام API URLs را مشخص می‌کند
```

### 🔴 **منطق کسب‌وکار**
```
backend/app/modules/hr/service.py
└─→ دارای منطق اصلی و تحقق‌ات
```

### 🔴 **دسترسی به داده**
```
backend/app/modules/hr/repository.py
└─→ SQL queries را نوشته می‌کند
```

---

## 🚀 خروجی درخواست‌ها

### ✅ درخواست موفق:
```json
{
  "status": 200,
  "data": {
    "users": [...]
  },
  "message": "موفق"
}
```

### ❌ درخواست ناموفق:
```json
{
  "status": 400,
  "error": "خطا در درخواست"
}
```

**کد‌های وضعیت HTTP:**
| کد | معنی | راه‌حل |
|----|------|--------|
| 200 | موفق | - |
| 400 | درخواست نامعتبر | داده ورودی را بررسی کنید |
| 401 | احراز هویت لازم است | لاگین کنید |
| 403 | مجوز ندارید | مجوزات کاربر را بررسی کنید |
| 404 | صفحه یافت نشد | endpoint را بررسی کنید |
| 500 | خطای سرور | لاگ‌های Backend را ببینید |

---

## 📊 نمودار فایل‌های مهم

```
درخواست کاربر
    ↓
frontend/src/views/*.vue (صفحه نمایش)
    ↓
frontend/src/api/hr.js (API call)
    ↓
backend/app/modules/hr/router.py (مسیر)
    ↓
backend/app/modules/hr/service.py (منطق)
    ↓
backend/app/modules/hr/repository.py (داده)
    ↓
backend/app/core/database.py (پایگاه داده)
    ↓
پایگاه داده (Database Server)
    ↓
پاسخ JSON برگشت
    ↓
frontend/src/views/*.vue (نمایش)
```

---

## 🔐 اعتبارسنجی و احراز هویت

**فایل‌های مربوطه:**
- `backend/app/core/auth.py` - منطق احراز هویت
- `backend/app/modules/hr/service.py` - بررسی مجوزات
- `frontend/src/api/hr.js` - ارسال token

**جریان:**
1. کاربر نام‌کاربری و رمز ورود را وارد می‌کند
2. Frontend به `/api/login` درخواست می‌دهد
3. Backend کاربر را تحقق می‌کند
4. Token یا Session برگشت داده می‌شود
5. Frontend token را ذخیره می‌کند
6. درخواست‌های بعدی token را شامل می‌کنند

---

## 📋 خلاصه سریع

| عنصر | موقعیت | نقش |
|------|--------|------|
| **صفحات Vue** | `frontend/src/views/` | نمایش داده و جمع‌آوری ورودی |
| **API Calls** | `frontend/src/api/` | ارسال درخواست‌ها به سرور |
| **مسیرها** | `backend/app/modules/hr/router.py` | تعیین endpoints |
| **منطق** | `backend/app/modules/hr/service.py` | اجرای منطق کسب‌وکار |
| **داده** | `backend/app/modules/hr/repository.py` | دریافت/ذخیره داده |
| **اتصال DB** | `backend/app/core/database.py` | ارتباط با پایگاه داده |
| **احراز** | `backend/app/core/auth.py` | تأیید هویت کاربر |
| **تنظیمات** | `backend/app/core/config.py` | پارامترهای سیستم |

---

## 🎓 نتیجه‌گیری

برای درک این پروژه:

1. **Frontend را شناخت:** صفحات Vue.js و API calls
2. **Backend را شناخت:** مسیرها، سرویس‌ها و repository
3. **Database را شناخت:** جداول و اتصال
4. **جریان را شناخت:** کاربر → Frontend → Backend → Database → پاسخ
5. **لاگ‌ها را چک کنید:** برای دیباگ مسائل

**اگر مشکلی پیش آمد:**
- ابتدا لاگ‌های سرور را ببینید
- سپس Network Tab در مرورگر را بررسی کنید
- سپس کد مربوطه را بررسی کنید
- در نهایت تنظیمات را بررسی کنید

---

*تاریخ ایجاد: 28 January 2026*
*برای سؤالات: راهنمای‌های دیگر را مطالعه کنید یا لاگ‌ها را بررسی کنید*
